<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nearby Bus Stops - City Bus Finder</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="page-wrapper">
    <nav class="top-nav">
      <ul class="nav-list">
        <li><a href="index.html" class="nav-link" data-page="home">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M3 11.5L12 4l9 7.5V20a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1z"
                  fill="none" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Home
        </a></li>
        <li><a href="nearby-stops.html" class="nav-link active" data-page="nearby-stops">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 21s7-7.75 7-13a7 7 0 0 0-14 0c0 5.25 7 13 7 13z"
                  fill="none" stroke="currentColor" stroke-width="2"/>
            <circle cx="12" cy="8" r="2.5" fill="none" stroke="currentColor" stroke-width="2"/>
          </svg>
          Nearby Bus Stops
        </a></li>
        <li><a href="bus-routes.html" class="nav-link" data-page="bus-routes">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <rect x="3" y="5" width="18" height="12" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
            <path d="M3 9h18M7 17v2M17 17v2" stroke="currentColor" stroke-width="2"/>
          </svg>
          Bus Routes
        </a></li>
        <li><a href="tourist-places.html" class="nav-link" data-page="tourist-places">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M3 6l6-2 6 2 6-2v14l-6 2-6-2-6 2z" fill="none" stroke="currentColor" stroke-width="2"/>
            <path d="M9 4v14M15 6v14" stroke="currentColor" stroke-width="2"/>
          </svg>
          Tourist Places Near Me
        </a></li>
        <li><a href="help.html" class="nav-link" data-page="help">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
            <path d="M9.5 9a2.5 2.5 0 1 1 3.5 2.3V14 M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Help
        </a></li>
      </ul>
    </nav>

    <section class="main-card" style="margin-top: 40px; max-width: 900px; margin-left: auto; margin-right: auto;">
      
      <!-- Location Banner -->
      <div class="location-banner">
        <div class="location-icon">
          <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 21s7-7.75 7-13a7 7 0 0 0-14 0c0 5.25 7 13 7 13z"/>
            <circle cx="12" cy="8" r="2.5"/>
          </svg>
        </div>
        <div class="location-text">
          <span>Showing bus stops near <strong>Your Location</strong></span>
        </div>
        <div class="location-arrow">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 18l6-6-6-6"/>
          </svg>
        </div>
      </div>

      <!-- Page Title -->
      <h1 class="page-title">Nearby Bus Stops</h1>

      <!-- Instructions -->
      <div class="instructions">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" style="margin-right: 8px;">
          <rect x="3" y="5" width="18" height="12" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
          <path d="M3 9h18M7 17v2M17 17v2" stroke="currentColor" stroke-width="2"/>
        </svg>
        <span><strong>Bus Stop</strong> üëâ Tap 'View Routes' to see buses</span>
      </div>

      <!-- Bus Stops List -->
      <div class="stops-list">
        
        <!-- Stop 1 -->
        <div class="stop-item">
          <div class="stop-icon">
            <svg viewBox="0 0 24 24" width="32" height="32" fill="none">
              <rect x="5" y="6" width="14" height="12" rx="2" fill="#43866B" stroke="#43866B" stroke-width="1.5"/>
              <rect x="7" y="9" width="4" height="4" rx="0.5" fill="white"/>
              <rect x="13" y="9" width="4" height="4" rx="0.5" fill="white"/>
              <circle cx="9" cy="19" r="1.5" fill="#43866B"/>
              <circle cx="15" cy="19" r="1.5" fill="#43866B"/>
              <line x1="5" y1="18" x2="5" y2="20" stroke="#43866B" stroke-width="1.5"/>
              <line x1="19" y1="18" x2="19" y2="20" stroke="#43866B" stroke-width="1.5"/>
            </svg>
          </div>
          <div class="stop-info">
            <h3>Main Street Station</h3>
            <p class="stop-distance">0.2 km away ‚Ä¢ Buses: 12, 45, 67, 89</p>
          </div>
          <button class="view-routes-btn">View Routes ‚Ä∫</button>
        </div>

        <!-- Stop 2 -->
        <div class="stop-item">
          <div class="stop-icon">
            <svg viewBox="0 0 24 24" width="32" height="32" fill="none">
              <rect x="5" y="6" width="14" height="12" rx="2" fill="#43866B" stroke="#43866B" stroke-width="1.5"/>
              <rect x="7" y="9" width="4" height="4" rx="0.5" fill="white"/>
              <rect x="13" y="9" width="4" height="4" rx="0.5" fill="white"/>
              <circle cx="9" cy="19" r="1.5" fill="#43866B"/>
              <circle cx="15" cy="19" r="1.5" fill="#43866B"/>
              <line x1="5" y1="18" x2="5" y2="20" stroke="#43866B" stroke-width="1.5"/>
              <line x1="19" y1="18" x2="19" y2="20" stroke="#43866B" stroke-width="1.5"/>
            </svg>
          </div>
          <div class="stop-info">
            <h3>City Center Terminal</h3>
            <p class="stop-distance">0.5 km away ‚Ä¢ Buses: 23, 34, 56, 78</p>
          </div>
          <button class="view-routes-btn">View Routes ‚Ä∫</button>
        </div>

        <!-- Stop 3 -->
        <div class="stop-item">
          <div class="stop-icon">
            <svg viewBox="0 0 24 24" width="32" height="32" fill="none">
              <rect x="5" y="6" width="14" height="12" rx="2" fill="#43866B" stroke="#43866B" stroke-width="1.5"/>
              <rect x="7" y="9" width="4" height="4" rx="0.5" fill="white"/>
              <rect x="13" y="9" width="4" height="4" rx="0.5" fill="white"/>
              <circle cx="9" cy="19" r="1.5" fill="#43866B"/>
              <circle cx="15" cy="19" r="1.5" fill="#43866B"/>
              <line x1="5" y1="18" x2="5" y2="20" stroke="#43866B" stroke-width="1.5"/>
              <line x1="19" y1="18" x2="19" y2="20" stroke="#43866B" stroke-width="1.5"/>
            </svg>
          </div>
          <div class="stop-info">
            <h3>Park Avenue Stop</h3>
            <p class="stop-distance">0.8 km away ‚Ä¢ Buses: 11, 22, 33</p>
          </div>
          <button class="view-routes-btn">View Routes ‚Ä∫</button>
        </div>

      </div>

    </section>
  </div>
  
  <script src="script.js"></script>
  <script>
    // Dynamic bus stops data (in production, this would come from an API)
    const busStopsData = [
      { name: 'Main Street Station', distance: 0.2, buses: [12, 45, 67, 89] },
      { name: 'City Center Terminal', distance: 0.5, buses: [23, 34, 56, 78] },
      { name: 'Park Avenue Stop', distance: 0.8, buses: [11, 22, 33] },
      { name: 'University Campus Gate', distance: 1.1, buses: [15, 25, 35] },
      { name: 'Shopping Mall Entrance', distance: 1.3, buses: [8, 18, 28, 38] },
      { name: 'Hospital Main Gate', distance: 1.5, buses: [9, 19, 29] }
    ];

    // Function to create bus icon SVG
    function createBusIcon() {
      return `
        <svg viewBox="0 0 24 24" width="32" height="32" fill="none">
          <rect x="5" y="6" width="14" height="12" rx="2" fill="#43866B" stroke="#43866B" stroke-width="1.5"/>
          <rect x="7" y="9" width="4" height="4" rx="0.5" fill="white"/>
          <rect x="13" y="9" width="4" height="4" rx="0.5" fill="white"/>
          <circle cx="9" cy="19" r="1.5" fill="#43866B"/>
          <circle cx="15" cy="19" r="1.5" fill="#43866B"/>
          <line x1="5" y1="18" x2="5" y2="20" stroke="#43866B" stroke-width="1.5"/>
          <line x1="19" y1="18" x2="19" y2="20" stroke="#43866B" stroke-width="1.5"/>
        </svg>
      `;
    }

    // Check if user wants to see more stops
    const urlParams = new URLSearchParams(window.location.search);
    const showAll = urlParams.get('showAll') === 'true';
    const stopsToShow = showAll ? busStopsData : busStopsData.slice(0, 3);

    // Generate stops dynamically
    const stopsList = document.querySelector('.stops-list');
    
    if (stopsList && stopsList.children.length === 3) {
      // Clear existing static content
      stopsList.innerHTML = '';
      
      // Add dynamic stops
      stopsToShow.forEach((stop, index) => {
        const stopItem = document.createElement('div');
        stopItem.className = 'stop-item';
        stopItem.style.opacity = '0';
        stopItem.style.transform = 'translateY(20px)';
        
        stopItem.innerHTML = `
          <div class="stop-icon">
            ${createBusIcon()}
          </div>
          <div class="stop-info">
            <h3>${stop.name}</h3>
            <p class="stop-distance">${stop.distance} km away ‚Ä¢ Buses: ${stop.buses.join(', ')}</p>
          </div>
          <button class="view-routes-btn" data-stop="${stop.name}">View Routes ‚Ä∫</button>
        `;
        
        stopsList.appendChild(stopItem);
        
        // Animate entry
        setTimeout(() => {
          stopItem.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
          stopItem.style.opacity = '1';
          stopItem.style.transform = 'translateY(0)';
        }, index * 100);
      });
      
      // Add "Show More" button if not all stops are shown
      if (!showAll && busStopsData.length > 3) {
        const showMoreBtn = document.createElement('button');
        showMoreBtn.className = 'search-btn';
        showMoreBtn.style.marginTop = '20px';
        showMoreBtn.style.width = '100%';
        showMoreBtn.textContent = `Show ${busStopsData.length - 3} More Stops`;
        
        showMoreBtn.addEventListener('click', function() {
          window.location.href = 'nearby-stops.html?showAll=true';
        });
        
        stopsList.parentElement.appendChild(showMoreBtn);
      }
      
      // Add event listeners to new buttons
      const viewRoutesButtons = stopsList.querySelectorAll('.view-routes-btn');
      viewRoutesButtons.forEach(button => {
        button.addEventListener('click', function() {
          const stopName = this.dataset.stop;
          
          // Show loading state
          this.textContent = 'Loading...';
          this.disabled = true;
          this.style.opacity = '0.7';
          
          setTimeout(() => {
            window.location.href = `bus-routes.html?stop=${encodeURIComponent(stopName)}`;
          }, 500);
        });
      });
      
      // Add click on bus numbers to show details
      stopsList.querySelectorAll('.stop-distance').forEach(distanceElement => {
        distanceElement.style.cursor = 'pointer';
        distanceElement.title = 'Click to see bus details';
        
        distanceElement.addEventListener('click', function(e) {
          e.stopPropagation();
          const text = this.textContent;
          const busNumbers = text.split('Buses:')[1].trim();
          alert(`Bus routes at this stop: ${busNumbers}\n\nClick "View Routes" for full schedule and timing.`);
        });
      });
    }
    
    // Add refresh location functionality
    const refreshBtn = document.createElement('button');
    refreshBtn.className = 'search-btn';
    refreshBtn.style.marginTop = '20px';
    refreshBtn.style.width = '100%';
    refreshBtn.style.background = '#43866B';
    refreshBtn.innerHTML = 'üîÑ Refresh My Location';
    
    refreshBtn.addEventListener('click', function() {
      this.textContent = 'üìç Getting Location...';
      this.disabled = true;
      
      if ("geolocation" in navigator) {
        navigator.geolocation.getCurrentPosition(
          function(position) {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            window.location.href = `nearby-stops.html?lat=${lat}&lon=${lon}`;
          },
          function(error) {
            alert('Unable to get your location. Please enable location services.');
            refreshBtn.textContent = 'üîÑ Refresh My Location';
            refreshBtn.disabled = false;
          }
        );
      }
    });
    
    if (stopsList && stopsList.parentElement) {
      stopsList.parentElement.appendChild(refreshBtn);
    }
  </script>
</body>
</html>
